<!DOCTYPE html>


<html lang="en-us" data-theme="">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>Spearman Rank in Standard Julia - Justin&#39;s Data Blog</title>

<meta name="description" content="Numerical Recipes in Julia.  Spearman Rank Correlation adapted to nearly standard Julia.">





<link rel="icon" type="image/x-icon" href="/ico/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="https://blog.jnapolitano.io/favicon.png">


<style>
  body {
    visibility: hidden;
    opacity: 0;
  }
</style>

<noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>



    





    
    
        
    
    

    
        <link rel="stylesheet" href="https://blog.jnapolitano.io/css/style.min.aadd6dd80ebf123717dcfe3d847163090d744aafb3d09e967f728dc0ef68bc1b.css" integrity="sha256-qt1t2A6/EjcX3P49hHFjCQ10Sq&#43;z0J6Wf3KNwO9ovBs=">
    





    

    





    
    
        
    
    

    
        <script src="https://blog.jnapolitano.io/js/script.min.510c781c39dbb21b4c76d85c82e2bdf4689220adbb7cd61e49e9d293e442fb42.js" type="text/javascript" charset="utf-8" integrity="sha256-UQx4HDnbshtMdthcguK99GiSIK27fNYeSenSk&#43;RC&#43;0I="></script>
    







<meta property="og:title" content="Spearman Rank in Standard Julia" />
<meta property="og:description" content="Numerical Recipes in Julia.  Spearman Rank Correlation adapted to nearly standard Julia." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.jnapolitano.io/posts/spearman_rank_julia/" /><meta property="og:image" content="https://blog.jnapolitano.io/featured-julia.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-30T20:20:32+00:00" />
<meta property="article:modified_time" content="2022-05-30T20:20:32+00:00" />
<meta property="og:see_also" content="https://blog.jnapolitano.io/posts/propensity_scoring/" /><meta property="og:see_also" content="https://blog.jnapolitano.io/posts/markov-models-julia/" /><meta property="og:see_also" content="https://blog.jnapolitano.io/posts/pi-with-julia/" /><meta property="og:see_also" content="https://blog.jnapolitano.io/posts/rocky-linux-8-julia/" />


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://blog.jnapolitano.io/featured-julia.png"/>

<meta name="twitter:title" content="Spearman Rank in Standard Julia"/>
<meta name="twitter:description" content="Numerical Recipes in Julia.  Spearman Rank Correlation adapted to nearly standard Julia."/>



    
        <link rel="webmention" href="https://webmention.io/hugo-theme-anubis/webmention" />
        
            <link rel="pingback" href="https://webmention.io/hugo-theme-anubis/xmlrpc" />
        
    
    
        <link rel="webmention" href="https://hugo-test-blog.jnapolitano.io/webmentions/receive" />
    






    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5H9YLZK4GH"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-5H9YLZK4GH', { 'anonymize_ip': false });
}
</script>





    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header"> 
            
                <div class="header-top">
    <h1 class="site-title">
    <a href="/">Justin&#39;s Data Blog</a>
</h1>
    <ul class="social-icons">


    
        
        
        <li>
            <a href="https://github.com/justin-napolitano" title="Github" rel="me">
            <span class="inline-svg" >




    
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

</span>

            </a>
        </li>
    

    
        
        
        <li>
            <a href="mailto:justin@jnapolitano.io" title="Email" rel="me">
            <span class="inline-svg" >




    
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg>

</span>

            </a>
        </li>
    

    
        
        
        <li>
            <a href="https://www.linkedin.com/in/justin-napolitano" title="Linkedin" rel="me">
            <span class="inline-svg" >




    
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

</span>

            </a>
        </li>
    

    
        
        
        <li>
            <a href="https://twitter.com/just_napolitano" title="Twitter" rel="me">
            <span class="inline-svg" >




    
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

</span>

            </a>
        </li>
    



    <li>
            <a href="https://blog.jnapolitano.io/index.xml" title="RSS" rel="me">
            <span class="inline-svg" >




    
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg>

</span>

            </a>
        </li>
    

</ul>
</div>

    <nav>
        
        
        <a class="" href="https://blog.jnapolitano.io" title="Feed">Feed</a>
        
        <a class="" href="https://blog.jnapolitano.io/series/" title="">Series</a>
        
        <a class="" href="https://blog.jnapolitano.io/categories/" title="">Categories</a>
        
        <a class="" href="https://blog.jnapolitano.io/tags/" title="">Tags</a>
        
        <a class="" href="https://blog.jnapolitano.io/posts/" title="Archive">Archive</a>
        
    </nav>




            
        </header>
        <main id="main" tabindex="-1"> 
            
    

    <article class="post h-entry">
        <div class="post-header">
            <header>
                <h1 class="p-name post-title">Spearman Rank in Standard Julia</h1>
                            


                
                
                

                
                    <p>Justin Napolitano</p>
                

                
                <p>2022-05-30 20:20:32.169 &#43;0000 UTC</p>
                    
                

                <hr/>
            </header>
        </div>
        <div class="content e-content">
            <h1>Table of Contents</h1>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#spearman-rank-in-standard-julia">Spearman Rank in Standard Julia</a></li>
    <li><a href="#special-thanks">Special Thanks</a></li>
    <li><a href="#update-there-is-a-website">Update: There is a Website!!!</a></li>
    <li><a href="#update-again">Update Again:</a></li>
    <li><a href="#using-specialfunctionserfc">Using SpecialFunctions:erfc</a></li>
    <li><a href="#spearman-correlation-function">Spearman Correlation Function.</a>
      <ul>
        <li><a href="#crank">Crank</a></li>
      </ul>
    </li>
    <li><a href="#main">Main()</a></li>
  </ul>
</nav>
            <hr/>
            
    
    <h1>Series</h1>
	<p><a href="/series/quantitative-analysis-in-julia" id="series">This is a post in the 
	<b>Quantitative Analysis in Julia</b></a> series.<br/>
    Other posts in this series:
    
    <ul class="series">
    
    <li class="list"><a href="/posts/spearman_rank_julia/">Spearman Rank in Standard Julia</a></li>
    </ul>
    
    <li class="list"><a href="/posts/propensity_scoring/">Churn Modelling Marketing Data with Julia</a></li>
    </ul>
    
    <li class="list"><a href="/posts/markov-models-julia/">Markov Chains in Julia</a></li>
    </ul>
    
    <li class="list"><a href="/posts/pi-with-julia/">Quantitative Julia Problems</a></li>
    </ul>
    
    <li class="list"><a href="/posts/rocky-linux-8-julia/">Configuring Rocky Linux 8 for Quantitative Analysis in Julia</a></li>
    </ul>
    

            <hr/>
            <h2 id="spearman-rank-in-standard-julia" >Spearman Rank in Standard Julia
<span>
    <a href="#spearman-rank-in-standard-julia">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>Well nearly, I did import the erfc function from the SpecialFunctions package.  I don&rsquo;t like it either.  I&rsquo;ll write my own soon to make up for it.</p>
<h2 id="special-thanks" >Special Thanks
<span>
    <a href="#special-thanks">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>I came across the text Numerical Recipes in C.  It was first published in 1988, by the Cambridge University Press.  The authors are William H. Press, Brian P. Flannery, Saul. A. Teukolsky, and William T. Veterling.</p>
<p>The book is beautiful.  You should try to find a copy.  It comes in Pascal and Fortran too!!!</p>
<p>I&rsquo;m having fun with it and will translate some of the recipes from my first love C to Julia.</p>
<p>I&rsquo;ll write up a review on the functions below in an upcoming edit.  I&rsquo;m so excited that it works that I had to publish.</p>
<h2 id="update-there-is-a-website" >Update: There is a Website!!!
<span>
    <a href="#update-there-is-a-website">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p><a href="http://numerical.recipes/">numerical.recipes</a> is a website with all of the code and the ebook.  I thought it was open source at first, but they want some money.  I guess it&rsquo;s okay, but still.  Check it out there.</p>
<p>The amazonbook link is below:</p>
<p>*<a href="https://www.amazon.com/Numerical-Recipes-Scientific-Computing-Second/dp/0521431085#:~:text=The%20product%20of%20a%20unique,to%20actual%20practical%20computer%20routines">book link</a>.</p>
<h2 id="update-again" >Update Again:
<span>
    <a href="#update-again">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>I found the PDF!  It is available via penn state university. Here&rsquo;s the <a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.129.5354&amp;rep=rep1&amp;type=pdf">download link</a></p>
<h2 id="using-specialfunctionserfc" >Using SpecialFunctions:erfc
<span>
    <a href="#using-specialfunctionserfc">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>I had to import the complementary error function.  I wanted to use just the standard library, but I had to test the code below first.  I&rsquo;ll write the compelemntary error function in pure julia next.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">
<span style="color:#66d9ef">using</span> SpecialFunctions<span style="color:#f92672">:</span>erfc
</code></pre></div><h2 id="spearman-correlation-function" >Spearman Correlation Function.
<span>
    <a href="#spearman-correlation-function">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>It takes:</p>
<ul>
<li>two distributions</li>
<li>the sample size</li>
</ul>
<p>It returns a t score  The original, used pointers to return multiple variables.  I&rsquo;ll probably rewrite the function to calculate the copmlimentary variables in seperate methods.  Might as well take advantage of the multiple dispatch capability of the language.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">function</span> spearman(data1,data2,n)

    j <span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> 
    
    wksp1m<span style="color:#f92672">=</span> <span style="color:#66d9ef">Vector</span>{<span style="color:#66d9ef">Float64</span>}(<span style="color:#ae81ff">0</span><span style="color:#f92672">:</span>n)
    wksp2m <span style="color:#f92672">=</span> <span style="color:#66d9ef">Vector</span>{<span style="color:#66d9ef">Float64</span>}(<span style="color:#ae81ff">0</span><span style="color:#f92672">:</span>n)
    
    <span style="color:#66d9ef">for</span> j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>(n)
        wksp1m[j]<span style="color:#f92672">=</span>data1[j]
        wksp2m[j]<span style="color:#f92672">=</span>data2[j]
    <span style="color:#66d9ef">end</span>

    sort!(wksp1m)
    sort!(wksp2m)

    sf <span style="color:#f92672">=</span> crank(n,wksp1m)
    sg <span style="color:#f92672">=</span> crank(n,wksp2m)

    d <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> 

    <span style="color:#66d9ef">for</span> j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>n
        d <span style="color:#f92672">+=</span> sqrt((<span style="color:#66d9ef">Complex</span>(wksp1m[j]<span style="color:#f92672">-</span>wksp2m[j])))
    <span style="color:#66d9ef">end</span>
    
    en<span style="color:#f92672">=</span>n
    en3n <span style="color:#f92672">=</span> (en<span style="color:#f92672">*</span>en<span style="color:#f92672">*</span>en)<span style="color:#f92672">-</span>en
    aved<span style="color:#f92672">=</span>(en3n<span style="color:#f92672">/</span><span style="color:#ae81ff">6.0</span>)<span style="color:#f92672">-</span>((sf<span style="color:#f92672">+</span>sg)<span style="color:#f92672">/</span><span style="color:#ae81ff">12</span>)
    fac<span style="color:#f92672">=</span>(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">-</span>sf<span style="color:#f92672">/</span>en3n)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">-</span>(sg<span style="color:#f92672">/</span>en3n))
    vard <span style="color:#f92672">=</span>((en<span style="color:#f92672">-</span><span style="color:#ae81ff">1.0</span>)<span style="color:#f92672">*</span>en<span style="color:#f92672">*</span>en<span style="color:#f92672">*</span>sqrt(en<span style="color:#f92672">+</span><span style="color:#ae81ff">1.0</span>)<span style="color:#f92672">/</span><span style="color:#ae81ff">36.0</span>)<span style="color:#f92672">*</span>fac
    zd <span style="color:#f92672">=</span> (d<span style="color:#f92672">-</span>aved<span style="color:#f92672">/</span>sqrt(vard))
    probd<span style="color:#f92672">=</span>erfc((abs(zd)<span style="color:#f92672">/</span><span style="color:#ae81ff">1.4142136</span>))
    rs <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1.0</span><span style="color:#f92672">-</span>(<span style="color:#ae81ff">6.0</span><span style="color:#f92672">/</span>en3n)<span style="color:#f92672">*</span>(d<span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>(sf<span style="color:#f92672">+</span>sg)))<span style="color:#f92672">/</span>fac
    t<span style="color:#f92672">=</span>(rs)<span style="color:#f92672">*</span>sqrt((en<span style="color:#f92672">-</span><span style="color:#ae81ff">2.0</span>)<span style="color:#f92672">/</span>((rs<span style="color:#f92672">+</span><span style="color:#ae81ff">1.0</span>)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1.0</span><span style="color:#f92672">-</span>rs)))
    <span style="color:#66d9ef">return</span> t
    
<span style="color:#66d9ef">end</span>
    
</code></pre></div><pre><code>spearman (generic function with 2 methods)
</code></pre>
<h3 id="crank" >Crank
<span>
    <a href="#crank">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h3><p>It ranks the distributions by modifying the original sorted array.  So very C.  I may play with this to return a new value, but I like that it modifies in place.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">function</span> crank(n,w)
    
    <span style="color:#75715e">#w= Vector{Float64}(1:n)</span>
    c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
        <span style="color:#66d9ef">if</span> w[j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">!=</span> w[j]
            w[j] <span style="color:#f92672">=</span> j
        <span style="color:#66d9ef">else</span>
            <span style="color:#66d9ef">for</span> jt <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>(n)
                <span style="color:#66d9ef">if</span> (w[jt] <span style="color:#f92672">!=</span> w[j])
                    <span style="color:#66d9ef">break</span>
                <span style="color:#66d9ef">end</span>
            <span style="color:#66d9ef">end</span>
            rank <span style="color:#f92672">=</span> <span style="color:#ae81ff">.5</span><span style="color:#f92672">*</span>(j<span style="color:#f92672">+</span>jt<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
            <span style="color:#66d9ef">for</span> ji <span style="color:#66d9ef">in</span> j<span style="color:#f92672">:</span>(jt<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
                w[ji] <span style="color:#f92672">=</span> rank
            <span style="color:#66d9ef">end</span>
            t <span style="color:#f92672">=</span> jt<span style="color:#f92672">-</span>j
            s <span style="color:#f92672">+=</span> t<span style="color:#f92672">*</span>t<span style="color:#f92672">*</span>t<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">end</span>
        c <span style="color:#f92672">=</span> j
        j<span style="color:#f92672">=</span>j
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">if</span> c <span style="color:#f92672">==</span> n 
        w[n]<span style="color:#f92672">=</span>n
    <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">return</span> s
<span style="color:#66d9ef">end</span>
</code></pre></div><pre><code>crank (generic function with 1 method)
</code></pre>
<h2 id="main" >Main()
<span>
    <a href="#main">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>Creates two random distributions and ranks tests them for correlation..</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">function</span> main()
    d1 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">5</span>rand()<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">for</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">50</span>]
    d2 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">3</span>rand()<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">for</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">50</span>]

    t <span style="color:#f92672">=</span>spearman(d1,d2,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>)
    display(t)
<span style="color:#66d9ef">end</span>
</code></pre></div><pre><code>main (generic function with 1 method)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">main()
</code></pre></div><pre><code>619.0719816953838 - 0.0im
</code></pre>

        </div>
        

    


<div class="post-info">

    
        <div class="post-date dt-published">2022-05-30</div>
    

    <a class="post-hidden-url u-url" href="https://blog.jnapolitano.io/posts/spearman_rank_julia/">https://blog.jnapolitano.io/posts/spearman_rank_julia/</a>
    <a href="https://blog.jnapolitano.io" class="p-name p-author post-hidden-author h-card" rel="me">Justin Napolitano</a>


    <div class="post-taxonomies">
        
            <ul class="post-series">
                
                    
                    <li><a href="">Series: Quantitative Analysis in Julia</a></li>
                
            </ul>
        
        
        
            <ul class="post-categories">
                
                    
                    <li><a href="https://blog.jnapolitano.io/categories/julia/">Julia</a></li>
                
                    
                    <li><a href="https://blog.jnapolitano.io/categories/tutorials/">Tutorials</a></li>
                
                    
                    <li><a href="">Quantitative Analysis</a></li>
                
                    
                    <li><a href="">Numerical Computing</a></li>
                
            </ul>
        
        
            <ul class="post-tags">
                
                    
                    <li><a href="https://blog.jnapolitano.io/tags/julia/">#julia</a></li>
                
                    
                    <li><a href="https://blog.jnapolitano.io/tags/numerical-computing/">#numerical-computing</a></li>
                
                    
                    <li><a href="https://blog.jnapolitano.io/tags/spearman-rank-correlation/">#spearman-rank-correlation</a></li>
                
                    
                    <li><a href="https://blog.jnapolitano.io/tags/statistics/">#statistics</a></li>
                
            </ul>
        
    </div>
</div>

        <hr/>
        
    
    <h1>Series</h1>
	<p><a href="/series/quantitative-analysis-in-julia" id="series">This is a post in the 
	<b>Quantitative Analysis in Julia</b></a> series.<br/>
    Other posts in this series:
    
    <ul class="series">
    
    <li class="list"><a href="/posts/spearman_rank_julia/">Spearman Rank in Standard Julia</a></li>
    </ul>
    
    <li class="list"><a href="/posts/propensity_scoring/">Churn Modelling Marketing Data with Julia</a></li>
    </ul>
    
    <li class="list"><a href="/posts/markov-models-julia/">Markov Chains in Julia</a></li>
    </ul>
    
    <li class="list"><a href="/posts/pi-with-julia/">Quantitative Julia Problems</a></li>
    </ul>
    
    <li class="list"><a href="/posts/rocky-linux-8-julia/">Configuring Rocky Linux 8 for Quantitative Analysis in Julia</a></li>
    </ul>
    

        <hr/>
    </article>



    
        
        
            <h3 class="read-next-title">Read next</h3>
            <ul class="read-next-posts">
                
                <li><a href="/posts/propensity_scoring/">Churn Modelling Marketing Data with Julia</a></li>
                
                <li><a href="/posts/markov-models-julia/">Markov Chains in Julia</a></li>
                
                <li><a href="/posts/pi-with-julia/">Quantitative Julia Problems</a></li>
                
                <li><a href="/posts/rocky-linux-8-julia/">Configuring Rocky Linux 8 for Quantitative Analysis in Julia</a></li>
                
                <li><a href="/posts/legal-research-part-7/">Legal Research with AI Part 7: Wrangling Data with Julia</a></li>
                
            </ul>
        
    

    

    
        
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "jnapolitano-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>









    

        </main>
        
            <footer class="common-footer">
    
    

    <div class="common-footer-bottom">
        
        <div class="copyright">
            <p>Â© Justin Napolitano, 2022<br>
            Maintained by Justin Napolitano.<br>
            
            </p>  
        </div> 

        

    



    <button class="theme-switcher">
        Dark theme
    </button>


<script>
const STORAGE_KEY = 'user-color-scheme'
const defaultTheme = "auto"

let currentTheme
let switchButton
let autoDefinedScheme = window.matchMedia('(prefers-color-scheme: dark)')

const autoChangeScheme = e => {
    currentTheme = e.matches ? 'dark' : 'light'
    document.documentElement.setAttribute('data-theme', currentTheme)
    changeButtonText()
}

document.addEventListener('DOMContentLoaded', function() {
    switchButton = document.querySelector('.theme-switcher')
    currentTheme = detectCurrentScheme()
    if (currentTheme == 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark')
    }
    if (currentTheme == 'auto') {
        autoChangeScheme(autoDefinedScheme);
        autoDefinedScheme.addListener(autoChangeScheme);
    }

    if (switchButton) {
        changeButtonText()
        switchButton.addEventListener('click', switchTheme, false)
    }
  
    showContent()
})

function detectCurrentScheme() {
    if (localStorage.getItem(STORAGE_KEY)) {
        return localStorage.getItem(STORAGE_KEY)
    } 
    if (defaultTheme) {
        return defaultTheme
    } 
    if (!window.matchMedia) {
        return 'light'
    } 
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        return 'dark'
    }
    return 'light'
}

function changeButtonText()
{   
    if (switchButton) {
        switchButton.textContent = currentTheme == 'dark' ?  "Light theme" : "Dark theme"
    }
}

function switchTheme(e) {
    if (currentTheme == 'dark') {
        localStorage.setItem(STORAGE_KEY, 'light')
        document.documentElement.setAttribute('data-theme', 'light')
        currentTheme = 'light'
    } else {
        localStorage.setItem(STORAGE_KEY, 'dark')
        document.documentElement.setAttribute('data-theme', 'dark')
        currentTheme = 'dark'
    }
    changeButtonText()
}

function showContent() {
    document.body.style.visibility = 'visible';
    document.body.style.opacity = 1;
}
</script>   
    </div>

    <p class="h-card vcard">

    <a href=https://blog.jnapolitano.io class="p-name u-url url fn" rel="me">Justin Napolitano</a> 

     
        /
        <a class="p-email u-email email" rel="me" href="mailto:justin@jnapolitano.io">justin@jnapolitano.io</a>
    

     
        <img class="u-photo" src="/images/me.png" />
    
</p> 
</footer>

        
    </div>
</body>
</html>
